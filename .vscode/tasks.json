{
    "options": {
        "env" : {
            "num_cpu":"4",
            "device" : "nemo@192.168.2.15",// default developer mode IP
            "sb2_target" : "SailfishOS-3.4.0.24-armv7hl",
            "SAILFISH_SDK" : "/home/developer/SailfishOS" // default SailfishSDK path
        }
    },
    "tasks": [
        {
            "type": "shell",
            "label": "Deploy nemo",
            "command": "rsync",
            "args": [
                "-zavP",
                "quake2-gles2","baseq2",
                "${device}:/home/nemo/Projects/quake2/"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Output/Targets/SailfishOS-32/Debug/bin/"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Copy compiled ARM build to device",
            // "dependsOn":["Build armv7hl"]
        },
        {
            "type": "shell",
            "label": "Build armv7hl",
            "command": "${SAILFISH_SDK}/bin/sfdk",
            "args": [
                "engine",
                "exec",
                "sb2","-t","${sb2_target}","make","-j${num_cpu}","config=debug","quake2-gles2"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Premake/Build-SailfishOS/gmake"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Build armv7hl SailfishOS binary"
        },
        {
            "type": "shell",
            "label": "Build GAME armv7hl",
            "command": "${SAILFISH_SDK}/bin/sfdk",
            "args": [
                "engine",
                "exec",
                "sb2","-t","${sb2_target}","make","-j${num_cpu}","config=debug","quake2-game"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Premake/Build-SailfishOS/gmake"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Build GAME"
        },
        {
            "type": "shell",
            "label": "Build Desktop",
            "command": "make",
            "args": [
                "-j4","config=debug","sailfish_fbo=yes","quake2-gles2"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Premake/Build-Linux/gmake"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Build Linux Desktop binary"
        },        
        {
            "type": "shell",
            "label": "Build Desktop Game",
            "command": "make",
            "args": [
                "-j${num_cpu}","config=debug","quake2-game"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Premake/Build-Linux/gmake"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Build Linux Desktop binary"
        },
        {
            "type": "shell",
            "label": "armv7hl: Install deps",
            "command": "${SAILFISH_SDK}/bin/sfdk",
            "args": [
                "engine",
                "exec",
                "sb2","-t","${sb2_target}","-m","sdk-install","-R",
                "zypper","in", "-y",
                "pulseaudio-devel",  "wayland-devel", "libGLESv1-devel", "wayland-egl-devel", "wayland-protocols-devel", "libusb-devel", 
                "libxkbcommon-devel"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Premake/Build-Linux/gmake"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Generated task by Debugger"
        },
        {
            "type": "shell",
            "label": "Configure SDL2",
            "command": "${SAILFISH_SDK}/bin/sfdk",
            "args": [
                "engine",
                "exec",
                "sb2","-t","${sb2_target}",
                "./configure", "--disable-video-x11","--enable-video-wayland","--enable-pulseaudio", "--disable-shared", "--enable-hidapi", "--enable-libudev"
                //"CFLAGS='-std=c99'", 
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/SDL2"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Generated task by Debugger"
        },
        {
            "type": "shell",
            "label": "Build SDL2",
            "command": "${SAILFISH_SDK}/bin/sfdk",
            "args": [
                "engine",
                "exec",
                "sb2","-t","${sb2_target}",
                "make", "-j${num_cpu}"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/SDL2"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Generated task by Debugger"
        },
        {
            "type": "shell",
            "label": "GDB server Nemo",
            "command": "ssh",
            "args": [
                "${device}",
                "gdbserver",":10001",
                "/home/nemo/Projects/quake2/quake2-gles2"
            ],
            "options": {
                // "cwd": "/usr/lib64/ccache"
                "cwd": "${workspaceFolder}/Ports/Quake2/Output/Targets/Linux-x86-32/Debug/bin/"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "dependsOn":["Deploy nemo"],
            "detail": "Run remote gdbserver",
        }
    ],
    "version": "2.0.0"
}